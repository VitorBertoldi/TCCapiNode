generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL") // vamos setar no .env
}

model employees {
  id           Int     @id @default(autoincrement())
  name         String  @db.VarChar(100)
  document     String  @unique @db.VarChar(20)
  base_salary  Decimal @db.Decimal(10, 2)
  dependents   Int     @default(0)
  union_member Boolean @default(false)

  entries  payroll_entries[]
  payrolls payrolls[]
}

model payroll_entries {
  id             Int     @id @default(autoincrement())
  employee_id    Int
  period         String  @db.VarChar(7)
  overtime_hours Decimal @default(0) @db.Decimal(10, 2)
  bonus          Decimal @default(0) @db.Decimal(10, 2)
  discounts      Decimal @default(0) @db.Decimal(10, 2)

  employee employees @relation(fields: [employee_id], references: [id])

  @@unique([employee_id, period], name: "uk_entry_emp_period")
  @@index([period])
}

model payrolls {
  id           Int     @id @default(autoincrement())
  employee_id  Int
  period       String  @db.VarChar(7)
  gross_salary Decimal @db.Decimal(10, 2)
  inss         Decimal @db.Decimal(10, 2)
  income_tax   Decimal @db.Decimal(10, 2)
  net_salary   Decimal @db.Decimal(10, 2)

  employee employees @relation(fields: [employee_id], references: [id])

  @@unique([employee_id, period], name: "uk_payroll_emp_period")
  @@index([period])
}
